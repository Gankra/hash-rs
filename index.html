<!DOCTYPE HTML>
<html>
<head>
<script src="//cdnjs.cloudflare.com/ajax/libs/dygraph/1.1.1/dygraph-combined.js"></script>
</head>
<body id="inject">
<p>
  These are benchmarks of how the different Rust hashing algorithm implementations
  compare. In particular, they are using the Hasher interface, which may not be
  optimal for all algorithms. Implementation quality may also vary.
</p>

<p>
  Numbers are generated from a MacBook Pro (x64 OSX) with a 2.8 GHz Intel Core
  i7 and 16GB of RAM.
</p>

<p>
  Variance bars excluded because this dang charting library was absolutely
  freaking out with them. Note also that both axes are on a log-scale, so small
  vertical differences may actually represent a large difference.
</p>

<p>
  <a href="https://github.com/Gankro/hash-rs">Source Can be Found Here</a>
</p>

<script type="text/javascript">

function makeBench(name, title, xLabel) {
  var benchDiv = document.createElement("div");
  var timeDiv = makeDiv();
  var tputDiv = makeDiv();
  var heading = document.createElement("h1");
  heading.textContent = title;
  heading.style = "text-align: center;"

  benchDiv.appendChild(heading);
  benchDiv.appendChild(timeDiv);
  benchDiv.appendChild(tputDiv);

  document.getElementById("inject").appendChild(benchDiv);

  makeGraph("Time (lower is better)",
            xLabel,
            "time (ns)",
            name + "-time.csv",
            timeDiv);

  makeGraph("Throughput (higher is better)",
            xLabel,
            "throughput (MB/s)",
            name + "-throughput.csv",
            tputDiv);
}

function makeDiv() {
  var div = document.createElement("div");
  div.style = "display: inline-block; width:650px; height:600px;";
  return div;
}

function makeGraph(title, xLabel, yLabel, csv, div) {
  var graph = new Dygraph(
    div,
    csv,
    {
      logscale: true,
      title: title,
      xlabel: xLabel,
      ylabel: yLabel,
      strokeWidth: 2.0,
      labelsDivWidth: 400,
      legend: "always",
      axes: {
        x: { logscale: true, drawGrid: false },
        y: { logscale: true, drawGrid: false },
      },
      series: {
        sip: { color: "#cc0000" },
        xx: { color: "#00cc00" },
        fnv: { color: "#0000cc" },
        farm: { color: "#cc00cc" },
        murmur: { color: "#cccc00" },
        city: { color: "#00cccc" },
        btree: { color: "#000000" },
      },
    }
  );
}

makeBench("bytes",
          "Hashing an array of bytes",
          "bytes hashed");

makeBench("mapcount",
          "Counting number of occurrences of 1000 byte-strings",
          "bytes per string");

</script>
</body>
</html>

